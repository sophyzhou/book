<!DOCTYPE html>
  <html>
    <head>
      <!--Import Google Icon Font-->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>

    <body>
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
      <script src="https://cdn.firebase.com/js/client/2.3.2/firebase.js"></script>

      <div class="container">

        <h1>
        <div align="center">Yun Zhou</div>
        </h1>

        <div align="center">
        <a href="subscription.html" class="waves-effect waves-light btn" id="submit">Subscribe</a>
        </div>

        <div id="content"> </div>
        <h2>Tasks</h2>
        <ul class="collapsible" data-collapsible="expandable", id="tasks"</ul>
      </div>

      <script>

        // create a firebase reference to the root
        var ref = new Firebase('https://ucdhw1.firebaseio.com')

        // read data from the location bio/Education, only once
        ref.child("bio").once('value',function(snapshot){
                var titles = snapshot.val()
                for (title in titles)
                {
                      console.log(titles[title])
                      $('#content').append('<h2>'+ title + '</h2>')
                    	$('#content').append('<ul class="collection" id="' + title + '">')
			           	    var elements = titles[title]
				            	for (element in elements)
					            {
					                 	$('#'+title).append('<li class="collection-item">' + elements[element] + '</li>')
				            	} 
					            $('#content').append('</ul>')
				        }
              }
        )

       // create a firebase reference to the root
        var ref = new Firebase('https://ucdd-todos-matrix.firebaseio.com/')


        function fill_container(task) {
            if (task["priority"] == null) {
                priority = "None"
            } else {
                priority = {"1":"high","2":"medium","3":"low"}[task["priority"]]
            }
            if(task["completed"] == false){
                $('#tasks').append('<li class="" xmlns="http://www.w3.org/1999/html"> \
                <div class="collapsible-header" style="padding-top: 6px"> <input type="checkbox" id='+key+' "\ ' +
                        'onclick=CheckButton("'+ key +'")> <label for='+key+'><font color="black">' + task["title"] + '</font></label></div>'  +
                        '<div class="collapsible-body" style="display: none; padding-top: 0px; margin-top: 0px; padding-bottom: 5px; padding-left: 50px; margin-bottom: 0px;">'
                        + 'Priority:\t' + priority + '<br>'
                        + 'Type:\t' + task["type"] + '<br>'
                        + 'Deadline:\t' + task["deadline"] + '<br> '
                        + 'Assigned:\t' + task["assigned"] + '</br>' +
                        '</li>')
            } else {
                  $('#tasks').append('<li class="" xmlns="http://www.w3.org/1999/html"> \
                  <div class="collapsible-header" style="padding-top: 6px"><input type="checkbox" id='+key+' checked="checked" "\ ' +
                        'onclick=CheckButton("'+ key +'")><label for='+key+'><font color="#cccccc">' + task["title"] + '</font></label></div>'  +
                        '<div class="collapsible-body" style="display: none; padding-top: 0px; margin-top: 0px; padding-bottom: 5px; padding-left: 50px; margin-bottom: 0px;">'
                        + 'Priority:\t' + priority + '<br>'
                        + 'Type:\t' + task["type"] + '<br>'
                        + 'Deadline:\t' + task["deadline"] + '<br> '
                        + 'Assigned:\t' + task["assigned"] + '</br>' +
                        '</li>')
               }
        }

        ref.child('todos/tasks').on("value", function(snapshot) {
          var tasks = snapshot.val()
          $('#tasks').empty()
          for (key in tasks) {
            task = tasks[key]
            if (task["assigned"] == "sophyzhou") {
              fill_container(task);
            } else {
              continue
          }
          }})
  

      </script>
    </body>
  </html>
